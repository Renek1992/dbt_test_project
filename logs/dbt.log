

============================== 2023-03-26 16:34:09.764698 | 8315f9f1-c63d-400e-9c26-d28a9b22fef1 ==============================
[0m16:34:09.764698 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:34:09.765794 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:34:09.766095 [debug] [MainThread]: Tracking: do not track
[0m16:34:09.811108 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:34:09.811983 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:34:10.652312 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m16:34:10.746198 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_eltool__orders' in the 'models' section of file 'models/staging/stg_eltool.yml'
[0m16:34:10.747730 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_eltool__state' in the 'models' section of file 'models/staging/stg_eltool.yml'
[0m16:34:10.851413 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sde_dbt_tutorial.marts.core
[0m16:34:10.877318 [info ] [MainThread]: Found 1 model, 5 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:34:10.880402 [info ] [MainThread]: 
[0m16:34:10.883367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:10.884482 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m16:34:10.899683 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m16:34:10.900199 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m16:34:10.900594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:10.953777 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m16:34:10.956270 [debug] [ThreadPool]: On list_dbt: Close
[0m16:34:10.959394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse'
[0m16:34:10.968948 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m16:34:10.969437 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
[0m16:34:10.969762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:10.983688 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:34:10.984305 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m16:34:10.984805 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m16:34:10.989186 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m16:34:10.990817 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
[0m16:34:10.992205 [debug] [ThreadPool]: On list_dbt_warehouse: Close
[0m16:34:10.993722 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m16:34:10.999977 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m16:34:11.000658 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m16:34:11.000997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:11.021279 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:34:11.021664 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m16:34:11.021960 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:34:11.026576 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m16:34:11.028458 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m16:34:11.029948 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m16:34:11.036061 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:11.036391 [debug] [MainThread]: On master: BEGIN
[0m16:34:11.036636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:11.067948 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:34:11.068442 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:11.068685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:34:11.081767 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m16:34:11.083173 [debug] [MainThread]: On master: ROLLBACK
[0m16:34:11.084469 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:11.084751 [debug] [MainThread]: On master: BEGIN
[0m16:34:11.086884 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:34:11.087208 [debug] [MainThread]: On master: COMMIT
[0m16:34:11.087462 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:11.087791 [debug] [MainThread]: On master: COMMIT
[0m16:34:11.089233 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:34:11.089553 [debug] [MainThread]: On master: Close
[0m16:34:11.090386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:11.090966 [info ] [MainThread]: 
[0m16:34:11.097270 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m16:34:11.098360 [info ] [Thread-1 (]: 1 of 1 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m16:34:11.099557 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m16:34:11.099937 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m16:34:11.103183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m16:34:11.104295 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-03-26 16:34:11.100161 => 2023-03-26 16:34:11.104154
[0m16:34:11.104854 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m16:34:11.185783 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m16:34:11.186746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m16:34:11.187010 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m16:34:11.187232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:11.197320 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:34:11.197943 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m16:34:11.198429 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
[0m16:34:11.201334 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "snapshots.customers_snapshot" does not exist
LINE 6:     from "dbt"."snapshots"."customers_snapshot"
                 ^

[0m16:34:11.201740 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: ROLLBACK
[0m16:34:11.203468 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-03-26 16:34:11.105325 => 2023-03-26 16:34:11.203339
[0m16:34:11.203812 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m16:34:11.211668 [debug] [Thread-1 (]: Database Error in model stg_eltool__customers (models/staging/stg_eltool__customers.sql)
  relation "snapshots.customers_snapshot" does not exist
  LINE 6:     from "dbt"."snapshots"."customers_snapshot"
                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_eltool__customers.sql
[0m16:34:11.212422 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model warehouse.stg_eltool__customers ........... [[31mERROR[0m in 0.11s]
[0m16:34:11.214453 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m16:34:11.215923 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:34:11.216266 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:11.216520 [debug] [MainThread]: On master: BEGIN
[0m16:34:11.216754 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:11.225328 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:34:11.225670 [debug] [MainThread]: On master: COMMIT
[0m16:34:11.225922 [debug] [MainThread]: Using postgres connection "master"
[0m16:34:11.226160 [debug] [MainThread]: On master: COMMIT
[0m16:34:11.227433 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:34:11.227853 [debug] [MainThread]: On master: Close
[0m16:34:11.228531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:11.228878 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__customers' was properly closed.
[0m16:34:11.229182 [info ] [MainThread]: 
[0m16:34:11.229602 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m16:34:11.230606 [debug] [MainThread]: Command end result
[0m16:34:11.238687 [info ] [MainThread]: 
[0m16:34:11.239384 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:34:11.239807 [info ] [MainThread]: 
[0m16:34:11.240590 [error] [MainThread]: [33mDatabase Error in model stg_eltool__customers (models/staging/stg_eltool__customers.sql)[0m
[0m16:34:11.240979 [error] [MainThread]:   relation "snapshots.customers_snapshot" does not exist
[0m16:34:11.241926 [error] [MainThread]:   LINE 6:     from "dbt"."snapshots"."customers_snapshot"
[0m16:34:11.242663 [error] [MainThread]:                    ^
[0m16:34:11.243507 [error] [MainThread]:   compiled Code at target/run/dbt_project/models/staging/stg_eltool__customers.sql
[0m16:34:11.244128 [info ] [MainThread]: 
[0m16:34:11.244681 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:34:11.245356 [debug] [MainThread]: Flushing usage events


============================== 2023-03-26 16:52:33.901857 | d3a0b2fb-ad83-47ee-a281-a44b67f48f06 ==============================
[0m16:52:33.901857 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:52:33.905036 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:52:33.905359 [debug] [MainThread]: Tracking: do not track
[0m16:52:33.943007 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:52:33.956968 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:52:34.711664 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m16:52:34.855593 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sde_dbt_tutorial.marts.core
[0m16:52:34.870139 [info ] [MainThread]: Found 1 model, 5 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:52:34.871937 [info ] [MainThread]: 
[0m16:52:34.874137 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:34.875574 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m16:52:34.891211 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m16:52:34.891638 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m16:52:34.891972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:34.928076 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m16:52:34.930195 [debug] [ThreadPool]: On list_dbt: Close
[0m16:52:34.932266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m16:52:34.939897 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m16:52:34.940242 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m16:52:34.940521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:34.954876 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:52:34.955418 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m16:52:34.976265 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:52:34.982126 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m16:52:34.998075 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m16:52:35.019918 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m16:52:35.038765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse'
[0m16:52:35.041226 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m16:52:35.041609 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
[0m16:52:35.041851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:35.052147 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:52:35.052550 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m16:52:35.052839 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m16:52:35.056308 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m16:52:35.057665 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
[0m16:52:35.058994 [debug] [ThreadPool]: On list_dbt_warehouse: Close
[0m16:52:35.066730 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:35.067069 [debug] [MainThread]: On master: BEGIN
[0m16:52:35.067307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:35.076268 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:52:35.076679 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:35.077130 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:35.092744 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m16:52:35.094293 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:35.095972 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:35.096337 [debug] [MainThread]: On master: BEGIN
[0m16:52:35.098950 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:52:35.099333 [debug] [MainThread]: On master: COMMIT
[0m16:52:35.099614 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:35.099852 [debug] [MainThread]: On master: COMMIT
[0m16:52:35.101166 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:52:35.101500 [debug] [MainThread]: On master: Close
[0m16:52:35.102145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:35.102659 [info ] [MainThread]: 
[0m16:52:35.108510 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m16:52:35.109490 [info ] [Thread-1 (]: 1 of 1 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m16:52:35.110335 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m16:52:35.110696 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m16:52:35.114024 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m16:52:35.114707 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-03-26 16:52:35.111131 => 2023-03-26 16:52:35.114616
[0m16:52:35.115018 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m16:52:35.162137 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m16:52:35.162971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m16:52:35.163322 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m16:52:35.163581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:35.173626 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:52:35.173953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m16:52:35.174177 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
[0m16:52:35.176151 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "snapshots.customers_snapshot" does not exist
LINE 6:     from "dbt"."snapshots"."customers_snapshot"
                 ^

[0m16:52:35.176555 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: ROLLBACK
[0m16:52:35.177883 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-03-26 16:52:35.115224 => 2023-03-26 16:52:35.177794
[0m16:52:35.178205 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m16:52:35.187085 [debug] [Thread-1 (]: Database Error in model stg_eltool__customers (models/staging/stg_eltool__customers.sql)
  relation "snapshots.customers_snapshot" does not exist
  LINE 6:     from "dbt"."snapshots"."customers_snapshot"
                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_eltool__customers.sql
[0m16:52:35.187690 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model warehouse.stg_eltool__customers ........... [[31mERROR[0m in 0.08s]
[0m16:52:35.189768 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m16:52:35.191214 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:35.191534 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:35.191767 [debug] [MainThread]: On master: BEGIN
[0m16:52:35.191989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:35.201825 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:52:35.202180 [debug] [MainThread]: On master: COMMIT
[0m16:52:35.202422 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:35.202648 [debug] [MainThread]: On master: COMMIT
[0m16:52:35.203684 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:52:35.203981 [debug] [MainThread]: On master: Close
[0m16:52:35.204832 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:35.205155 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__customers' was properly closed.
[0m16:52:35.205444 [info ] [MainThread]: 
[0m16:52:35.205826 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m16:52:35.206304 [debug] [MainThread]: Command end result
[0m16:52:35.215032 [info ] [MainThread]: 
[0m16:52:35.215601 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:52:35.216097 [info ] [MainThread]: 
[0m16:52:35.216508 [error] [MainThread]: [33mDatabase Error in model stg_eltool__customers (models/staging/stg_eltool__customers.sql)[0m
[0m16:52:35.217032 [error] [MainThread]:   relation "snapshots.customers_snapshot" does not exist
[0m16:52:35.217627 [error] [MainThread]:   LINE 6:     from "dbt"."snapshots"."customers_snapshot"
[0m16:52:35.218003 [error] [MainThread]:                    ^
[0m16:52:35.218488 [error] [MainThread]:   compiled Code at target/run/dbt_project/models/staging/stg_eltool__customers.sql
[0m16:52:35.219038 [info ] [MainThread]: 
[0m16:52:35.219913 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:52:35.220643 [debug] [MainThread]: Flushing usage events


============================== 2023-03-26 17:12:40.134051 | aca8fdb2-17c3-4b0e-94f6-dda860549e40 ==============================
[0m17:12:40.134051 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:12:40.137338 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:12:40.137704 [debug] [MainThread]: Tracking: do not track
[0m17:12:40.176706 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:12:40.189605 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:12:40.952639 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m17:12:41.112105 [info ] [MainThread]: Found 1 model, 5 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m17:12:41.114108 [info ] [MainThread]: 
[0m17:12:41.116212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:41.117427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m17:12:41.129588 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m17:12:41.130124 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m17:12:41.130599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:41.168419 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m17:12:41.171050 [debug] [ThreadPool]: On list_dbt: Close
[0m17:12:41.173614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse'
[0m17:12:41.181523 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m17:12:41.181919 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
[0m17:12:41.182184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:41.193084 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:12:41.193429 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m17:12:41.193685 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m17:12:41.197807 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m17:12:41.199459 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
[0m17:12:41.200814 [debug] [ThreadPool]: On list_dbt_warehouse: Close
[0m17:12:41.202246 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m17:12:41.206751 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m17:12:41.207067 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m17:12:41.207302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:41.214620 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:12:41.214956 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m17:12:41.215192 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m17:12:41.218321 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m17:12:41.219640 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m17:12:41.220934 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m17:12:41.225601 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:41.225913 [debug] [MainThread]: On master: BEGIN
[0m17:12:41.226145 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:41.235679 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:41.236276 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:41.236922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:41.247974 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m17:12:41.249207 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:41.250405 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:41.250692 [debug] [MainThread]: On master: BEGIN
[0m17:12:41.253296 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:41.253661 [debug] [MainThread]: On master: COMMIT
[0m17:12:41.253921 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:41.254145 [debug] [MainThread]: On master: COMMIT
[0m17:12:41.255309 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:12:41.255601 [debug] [MainThread]: On master: Close
[0m17:12:41.256194 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:41.256573 [info ] [MainThread]: 
[0m17:12:41.262977 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m17:12:41.263474 [info ] [Thread-1 (]: 1 of 1 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m17:12:41.264188 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m17:12:41.264487 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m17:12:41.267055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m17:12:41.269288 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-03-26 17:12:41.264694 => 2023-03-26 17:12:41.269086
[0m17:12:41.269869 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m17:12:41.319442 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m17:12:41.320211 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m17:12:41.320470 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m17:12:41.320691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:41.330312 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m17:12:41.330637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m17:12:41.330855 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
[0m17:12:41.332630 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "snapshots.customers_snapshot" does not exist
LINE 6:     from "dbt"."snapshots"."customers_snapshot"
                 ^

[0m17:12:41.332973 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: ROLLBACK
[0m17:12:41.334255 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-03-26 17:12:41.270207 => 2023-03-26 17:12:41.334173
[0m17:12:41.334558 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m17:12:41.342397 [debug] [Thread-1 (]: Database Error in model stg_eltool__customers (models/staging/stg_eltool__customers.sql)
  relation "snapshots.customers_snapshot" does not exist
  LINE 6:     from "dbt"."snapshots"."customers_snapshot"
                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_eltool__customers.sql
[0m17:12:41.342982 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model warehouse.stg_eltool__customers ........... [[31mERROR[0m in 0.08s]
[0m17:12:41.344826 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m17:12:41.346166 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:41.346500 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:41.346733 [debug] [MainThread]: On master: BEGIN
[0m17:12:41.346957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:41.355410 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:41.355752 [debug] [MainThread]: On master: COMMIT
[0m17:12:41.355989 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:41.356212 [debug] [MainThread]: On master: COMMIT
[0m17:12:41.357182 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:12:41.357458 [debug] [MainThread]: On master: Close
[0m17:12:41.358006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:41.358306 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__customers' was properly closed.
[0m17:12:41.358757 [info ] [MainThread]: 
[0m17:12:41.359339 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m17:12:41.359969 [debug] [MainThread]: Command end result
[0m17:12:41.371218 [info ] [MainThread]: 
[0m17:12:41.372093 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:12:41.372743 [info ] [MainThread]: 
[0m17:12:41.373308 [error] [MainThread]: [33mDatabase Error in model stg_eltool__customers (models/staging/stg_eltool__customers.sql)[0m
[0m17:12:41.373756 [error] [MainThread]:   relation "snapshots.customers_snapshot" does not exist
[0m17:12:41.374158 [error] [MainThread]:   LINE 6:     from "dbt"."snapshots"."customers_snapshot"
[0m17:12:41.374485 [error] [MainThread]:                    ^
[0m17:12:41.374798 [error] [MainThread]:   compiled Code at target/run/dbt_project/models/staging/stg_eltool__customers.sql
[0m17:12:41.375127 [info ] [MainThread]: 
[0m17:12:41.375734 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:12:41.376230 [debug] [MainThread]: Flushing usage events


============================== 2023-03-26 20:24:27.741004 | 1bcde4ae-e8a0-4acd-ae53-1e90169ade99 ==============================
[0m20:24:27.741004 [info ] [MainThread]: Running with dbt=1.4.5
[0m20:24:27.743991 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'snapshot', 'rpc_method': 'snapshot', 'indirect_selection': 'eager'}
[0m20:24:27.744297 [debug] [MainThread]: Tracking: do not track
[0m20:24:27.776383 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m20:24:27.832835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:24:27.833142 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:24:27.853585 [info ] [MainThread]: Found 1 model, 5 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:24:27.855527 [info ] [MainThread]: 
[0m20:24:27.857777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:24:27.859031 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m20:24:27.872860 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m20:24:27.873303 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m20:24:27.873631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:27.928289 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m20:24:27.930029 [debug] [ThreadPool]: On list_dbt: Close
[0m20:24:27.931788 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m20:24:27.938257 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m20:24:27.938571 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m20:24:27.938807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:27.946805 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:24:27.947163 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m20:24:27.947413 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m20:24:27.952572 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m20:24:27.953821 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m20:24:27.954925 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m20:24:27.955852 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse'
[0m20:24:27.957804 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m20:24:27.958097 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
[0m20:24:27.958381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:27.966364 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:24:27.966717 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m20:24:27.966955 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m20:24:27.969891 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m20:24:27.971218 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
[0m20:24:27.972328 [debug] [ThreadPool]: On list_dbt_warehouse: Close
[0m20:24:27.978699 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:27.979014 [debug] [MainThread]: On master: BEGIN
[0m20:24:27.979277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:24:27.987442 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:24:27.987771 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:27.988005 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:24:27.999203 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m20:24:28.000511 [debug] [MainThread]: On master: ROLLBACK
[0m20:24:28.002352 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:28.002617 [debug] [MainThread]: On master: BEGIN
[0m20:24:28.004725 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:24:28.005034 [debug] [MainThread]: On master: COMMIT
[0m20:24:28.005279 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:28.005500 [debug] [MainThread]: On master: COMMIT
[0m20:24:28.006601 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:24:28.006891 [debug] [MainThread]: On master: Close
[0m20:24:28.007522 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:24:28.007976 [info ] [MainThread]: 
[0m20:24:28.012550 [debug] [Thread-1 (]: Began running node snapshot.dbt_project.customers_snapshot
[0m20:24:28.012969 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m20:24:28.013617 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_project.customers_snapshot'
[0m20:24:28.013892 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_project.customers_snapshot
[0m20:24:28.017192 [debug] [Thread-1 (]: Timing info for snapshot.dbt_project.customers_snapshot (compile): 2023-03-26 20:24:28.014093 => 2023-03-26 20:24:28.017110
[0m20:24:28.017542 [debug] [Thread-1 (]: Began executing node snapshot.dbt_project.customers_snapshot
[0m20:24:28.075723 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_project.customers_snapshot"
[0m20:24:28.078284 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_project.customers_snapshot"
[0m20:24:28.078825 [debug] [Thread-1 (]: On snapshot.dbt_project.customers_snapshot: BEGIN
[0m20:24:28.079494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:28.089552 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:24:28.089880 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_project.customers_snapshot"
[0m20:24:28.090232 [debug] [Thread-1 (]: On snapshot.dbt_project.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "snapshot.dbt_project.customers_snapshot"} */

      
  
    

  create  table "dbt"."snapshots"."customers_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id,
        datetime_updated as dbt_updated_at,
        datetime_updated as dbt_valid_from,
        nullif(datetime_updated, datetime_updated) as dbt_valid_to
    from (
        



select * from "dbt"."warehouse"."customers"

    ) sbq



  );
  
  
[0m20:24:28.111295 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0 seconds
[0m20:24:28.132730 [debug] [Thread-1 (]: On snapshot.dbt_project.customers_snapshot: COMMIT
[0m20:24:28.133026 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_project.customers_snapshot"
[0m20:24:28.133229 [debug] [Thread-1 (]: On snapshot.dbt_project.customers_snapshot: COMMIT
[0m20:24:28.136809 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m20:24:28.137634 [debug] [Thread-1 (]: Timing info for snapshot.dbt_project.customers_snapshot (execute): 2023-03-26 20:24:28.017731 => 2023-03-26 20:24:28.137576
[0m20:24:28.137894 [debug] [Thread-1 (]: On snapshot.dbt_project.customers_snapshot: Close
[0m20:24:28.138721 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.13s]
[0m20:24:28.140622 [debug] [Thread-1 (]: Finished running node snapshot.dbt_project.customers_snapshot
[0m20:24:28.142588 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:24:28.143025 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:28.143348 [debug] [MainThread]: On master: BEGIN
[0m20:24:28.143637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:24:28.151217 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:24:28.151550 [debug] [MainThread]: On master: COMMIT
[0m20:24:28.151794 [debug] [MainThread]: Using postgres connection "master"
[0m20:24:28.152032 [debug] [MainThread]: On master: COMMIT
[0m20:24:28.152920 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:24:28.153217 [debug] [MainThread]: On master: Close
[0m20:24:28.153742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:28.154001 [debug] [MainThread]: Connection 'snapshot.dbt_project.customers_snapshot' was properly closed.
[0m20:24:28.154274 [info ] [MainThread]: 
[0m20:24:28.154650 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m20:24:28.155162 [debug] [MainThread]: Command end result
[0m20:24:28.163711 [info ] [MainThread]: 
[0m20:24:28.164207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:24:28.164539 [info ] [MainThread]: 
[0m20:24:28.164861 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:24:28.165388 [debug] [MainThread]: Flushing usage events


============================== 2023-03-26 20:26:24.102073 | 9734d4bd-36cb-435d-b233-7fd270304674 ==============================
[0m20:26:24.102073 [info ] [MainThread]: Running with dbt=1.4.5
[0m20:26:24.104620 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:26:24.104987 [debug] [MainThread]: Tracking: do not track
[0m20:26:24.131449 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m20:26:24.163978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:26:24.164273 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:26:24.179038 [info ] [MainThread]: Found 1 model, 5 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:26:24.180895 [info ] [MainThread]: 
[0m20:26:24.183087 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:26:24.184091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m20:26:24.197851 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m20:26:24.198214 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m20:26:24.198481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:24.222412 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m20:26:24.224121 [debug] [ThreadPool]: On list_dbt: Close
[0m20:26:24.225772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse'
[0m20:26:24.232997 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m20:26:24.233331 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
[0m20:26:24.233589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:24.244059 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:26:24.244405 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m20:26:24.244648 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m20:26:24.247602 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m20:26:24.248931 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
[0m20:26:24.249957 [debug] [ThreadPool]: On list_dbt_warehouse: Close
[0m20:26:24.250849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m20:26:24.254460 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m20:26:24.254758 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m20:26:24.254993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:26:24.262775 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:26:24.263133 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m20:26:24.263388 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m20:26:24.266480 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m20:26:24.267775 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m20:26:24.268751 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m20:26:24.273253 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:24.273571 [debug] [MainThread]: On master: BEGIN
[0m20:26:24.273811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:24.281374 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:26:24.281696 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:24.281944 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:26:24.291164 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m20:26:24.292430 [debug] [MainThread]: On master: ROLLBACK
[0m20:26:24.293804 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:24.294104 [debug] [MainThread]: On master: BEGIN
[0m20:26:24.295792 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:26:24.296099 [debug] [MainThread]: On master: COMMIT
[0m20:26:24.296366 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:24.296585 [debug] [MainThread]: On master: COMMIT
[0m20:26:24.297607 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:26:24.297901 [debug] [MainThread]: On master: Close
[0m20:26:24.298470 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:26:24.298878 [info ] [MainThread]: 
[0m20:26:24.302120 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m20:26:24.302557 [info ] [Thread-1 (]: 1 of 1 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m20:26:24.303252 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m20:26:24.303538 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m20:26:24.306204 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m20:26:24.306787 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-03-26 20:26:24.303739 => 2023-03-26 20:26:24.306707
[0m20:26:24.307066 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m20:26:24.350231 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m20:26:24.350898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:26:24.351124 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m20:26:24.351333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:24.359586 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:26:24.359906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:26:24.360136 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
[0m20:26:24.366110 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m20:26:24.372352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:26:24.372641 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:26:24.375364 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:26:24.392831 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:26:24.393156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:26:24.393370 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:26:24.396421 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m20:26:24.402028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:26:24.402322 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop view if exists "dbt"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m20:26:24.404608 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m20:26:24.405913 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-03-26 20:26:24.307271 => 2023-03-26 20:26:24.405859
[0m20:26:24.406179 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m20:26:24.406968 [info ] [Thread-1 (]: 1 of 1 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.10s]
[0m20:26:24.409007 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m20:26:24.410557 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:26:24.410905 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:24.411172 [debug] [MainThread]: On master: BEGIN
[0m20:26:24.411407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:26:24.418576 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:26:24.418917 [debug] [MainThread]: On master: COMMIT
[0m20:26:24.419155 [debug] [MainThread]: Using postgres connection "master"
[0m20:26:24.419375 [debug] [MainThread]: On master: COMMIT
[0m20:26:24.420317 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:26:24.420584 [debug] [MainThread]: On master: Close
[0m20:26:24.421150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:24.421397 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__customers' was properly closed.
[0m20:26:24.421638 [info ] [MainThread]: 
[0m20:26:24.421965 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m20:26:24.422399 [debug] [MainThread]: Command end result
[0m20:26:24.429194 [info ] [MainThread]: 
[0m20:26:24.430100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:26:24.430617 [info ] [MainThread]: 
[0m20:26:24.431006 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:26:24.431504 [debug] [MainThread]: Flushing usage events


============================== 2023-03-26 20:48:14.074206 | b684ef60-1285-4c0b-9746-068e4e63887c ==============================
[0m20:48:14.074206 [info ] [MainThread]: Running with dbt=1.4.5
[0m20:48:14.077265 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:48:14.077643 [debug] [MainThread]: Tracking: do not track
[0m20:48:14.115557 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m20:48:14.176701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m20:48:14.177305 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/stg_eltool__state.sql
[0m20:48:14.177621 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/stg_eltool__orders.sql
[0m20:48:14.177997 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/stg_eltool.yml
[0m20:48:14.178354 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/stg_eltool__customers.sql
[0m20:48:14.194520 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
[0m20:48:14.210069 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
[0m20:48:14.213046 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m20:48:14.262276 [info ] [MainThread]: Found 3 models, 7 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:48:14.264130 [info ] [MainThread]: 
[0m20:48:14.266187 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:48:14.267351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m20:48:14.279711 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m20:48:14.280057 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m20:48:14.280314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:48:14.314472 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m20:48:14.316335 [debug] [ThreadPool]: On list_dbt: Close
[0m20:48:14.317981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m20:48:14.325230 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m20:48:14.325616 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m20:48:14.325916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:14.334475 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:48:14.334807 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m20:48:14.335045 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m20:48:14.337955 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m20:48:14.339246 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m20:48:14.340337 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m20:48:14.341253 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse'
[0m20:48:14.344675 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m20:48:14.344964 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
[0m20:48:14.345190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:48:14.352835 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:48:14.353194 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m20:48:14.353438 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m20:48:14.357042 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m20:48:14.358388 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
[0m20:48:14.359513 [debug] [ThreadPool]: On list_dbt_warehouse: Close
[0m20:48:14.364405 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:14.364720 [debug] [MainThread]: On master: BEGIN
[0m20:48:14.364956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:14.373080 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:48:14.373437 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:14.373670 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:48:14.384028 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m20:48:14.385529 [debug] [MainThread]: On master: ROLLBACK
[0m20:48:14.387062 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:14.387385 [debug] [MainThread]: On master: BEGIN
[0m20:48:14.390318 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:48:14.390687 [debug] [MainThread]: On master: COMMIT
[0m20:48:14.390947 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:14.391185 [debug] [MainThread]: On master: COMMIT
[0m20:48:14.392866 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:48:14.393206 [debug] [MainThread]: On master: Close
[0m20:48:14.393825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:48:14.394330 [info ] [MainThread]: 
[0m20:48:14.398527 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m20:48:14.398950 [info ] [Thread-1 (]: 1 of 3 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m20:48:14.399639 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m20:48:14.399910 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m20:48:14.403260 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m20:48:14.404508 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-03-26 20:48:14.400113 => 2023-03-26 20:48:14.404414
[0m20:48:14.404825 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m20:48:14.447326 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m20:48:14.447973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:48:14.448196 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m20:48:14.448400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:14.458628 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:48:14.458948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:48:14.459232 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), 
renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
[0m20:48:14.462721 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m20:48:14.469231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:48:14.469540 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:48:14.471179 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:48:14.474276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:48:14.474549 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:48:14.476801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:48:14.495979 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:48:14.496271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:48:14.496479 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:48:14.498973 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m20:48:14.504283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:48:14.504561 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop view if exists "dbt"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m20:48:14.513386 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m20:48:14.514720 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-03-26 20:48:14.405034 => 2023-03-26 20:48:14.514663
[0m20:48:14.514980 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m20:48:14.515732 [info ] [Thread-1 (]: 1 of 3 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.12s]
[0m20:48:14.517512 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m20:48:14.517984 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m20:48:14.518474 [info ] [Thread-1 (]: 2 of 3 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m20:48:14.519131 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__orders'
[0m20:48:14.519403 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m20:48:14.521998 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m20:48:14.522870 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 2023-03-26 20:48:14.519584 => 2023-03-26 20:48:14.522802
[0m20:48:14.523157 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m20:48:14.527648 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m20:48:14.528222 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:48:14.528449 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m20:48:14.528653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:14.537846 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:48:14.538210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:48:14.538437 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  create view "dbt"."warehouse"."stg_eltool__orders__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."warehouse"."orders"
),
renamed as (
    select order_id,
        cust_id AS customer_id,
        order_status,
        order_purchase_timestamp::TIMESTAMP,
        order_approved_at::TIMESTAMP,
        order_delivered_carrier_date::TIMESTAMP,
        order_delivered_customer_date::TIMESTAMP,
        order_estimated_delivery_date::TIMESTAMP
        from source
)
select *
from renamed
  );
[0m20:48:14.541699 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m20:48:14.544460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:48:14.544712 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:48:14.546090 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:48:14.547888 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:48:14.548132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:48:14.548347 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:48:14.549903 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m20:48:14.553140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:48:14.553423 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop view if exists "dbt"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m20:48:14.555482 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m20:48:14.557198 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 2023-03-26 20:48:14.523344 => 2023-03-26 20:48:14.557137
[0m20:48:14.557545 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m20:48:14.558397 [info ] [Thread-1 (]: 2 of 3 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.04s]
[0m20:48:14.558908 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m20:48:14.559362 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m20:48:14.559849 [info ] [Thread-1 (]: 3 of 3 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m20:48:14.560580 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__state'
[0m20:48:14.561103 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m20:48:14.563628 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m20:48:14.564159 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 2023-03-26 20:48:14.561339 => 2023-03-26 20:48:14.564100
[0m20:48:14.564426 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m20:48:14.568593 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m20:48:14.569122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:48:14.569359 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m20:48:14.569564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:48:14.578511 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:48:14.578844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:48:14.579077 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  create view "dbt"."warehouse"."stg_eltool__state__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."warehouse"."state"
),
renamed as (
    select state_identifier::INT AS state_id,
        state_code::VARCHAR(2) AS state_code,
        st_name::VARCHAR(30) AS state_name
    from source
)
select *
from renamed
  );
[0m20:48:14.581719 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m20:48:14.585362 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:48:14.585671 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:48:14.587558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:48:14.589850 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:48:14.590275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:48:14.590624 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:48:14.592897 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m20:48:14.595068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:48:14.595339 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop view if exists "dbt"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m20:48:14.596832 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m20:48:14.598125 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 2023-03-26 20:48:14.564605 => 2023-03-26 20:48:14.598071
[0m20:48:14.598400 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m20:48:14.599151 [info ] [Thread-1 (]: 3 of 3 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.04s]
[0m20:48:14.599622 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m20:48:14.600902 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:48:14.601234 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:14.601563 [debug] [MainThread]: On master: BEGIN
[0m20:48:14.601864 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:48:14.610873 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:48:14.611225 [debug] [MainThread]: On master: COMMIT
[0m20:48:14.611469 [debug] [MainThread]: Using postgres connection "master"
[0m20:48:14.611692 [debug] [MainThread]: On master: COMMIT
[0m20:48:14.612707 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:48:14.613009 [debug] [MainThread]: On master: Close
[0m20:48:14.613548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:48:14.613805 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__state' was properly closed.
[0m20:48:14.614061 [info ] [MainThread]: 
[0m20:48:14.614422 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m20:48:14.614992 [debug] [MainThread]: Command end result
[0m20:48:14.621449 [info ] [MainThread]: 
[0m20:48:14.622035 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:48:14.622533 [info ] [MainThread]: 
[0m20:48:14.623103 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:48:14.623756 [debug] [MainThread]: Flushing usage events


============================== 2023-03-26 20:55:16.075036 | d635f417-908f-4282-8ed9-811018bf7f86 ==============================
[0m20:55:16.075036 [info ] [MainThread]: Running with dbt=1.4.5
[0m20:55:16.078498 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:55:16.078867 [debug] [MainThread]: Tracking: do not track
[0m20:55:16.112103 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m20:55:16.123206 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:55:16.830820 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m20:55:16.846041 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
[0m20:55:16.849835 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
[0m20:55:16.997392 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.sde_dbt_tutorial.staging
[0m20:55:17.016708 [info ] [MainThread]: Found 3 models, 7 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:55:17.019818 [info ] [MainThread]: 
[0m20:55:17.023107 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:55:17.024864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m20:55:17.038399 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m20:55:17.038759 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m20:55:17.039018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:55:17.063105 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m20:55:17.064885 [debug] [ThreadPool]: On list_dbt: Close
[0m20:55:17.066576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse'
[0m20:55:17.073307 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m20:55:17.073661 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
[0m20:55:17.073900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:17.084467 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:55:17.084885 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m20:55:17.085145 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m20:55:17.088436 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m20:55:17.089876 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
[0m20:55:17.090899 [debug] [ThreadPool]: On list_dbt_warehouse: Close
[0m20:55:17.091883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m20:55:17.096258 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m20:55:17.096558 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m20:55:17.096798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:55:17.104544 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:55:17.104879 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m20:55:17.105115 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m20:55:17.108075 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m20:55:17.109352 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m20:55:17.110566 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m20:55:17.115508 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:17.115832 [debug] [MainThread]: On master: BEGIN
[0m20:55:17.116064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:55:17.123103 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:55:17.123446 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:17.123683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:55:17.135070 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m20:55:17.136811 [debug] [MainThread]: On master: ROLLBACK
[0m20:55:17.138179 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:17.138478 [debug] [MainThread]: On master: BEGIN
[0m20:55:17.140534 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:55:17.140865 [debug] [MainThread]: On master: COMMIT
[0m20:55:17.141118 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:17.141346 [debug] [MainThread]: On master: COMMIT
[0m20:55:17.142245 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:55:17.142524 [debug] [MainThread]: On master: Close
[0m20:55:17.143097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:55:17.143462 [info ] [MainThread]: 
[0m20:55:17.146841 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m20:55:17.147300 [info ] [Thread-1 (]: 1 of 3 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m20:55:17.147974 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m20:55:17.148274 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m20:55:17.150815 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m20:55:17.151452 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-03-26 20:55:17.148487 => 2023-03-26 20:55:17.151364
[0m20:55:17.151756 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m20:55:17.193137 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m20:55:17.193780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:55:17.194014 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m20:55:17.194218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:17.203959 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:55:17.204287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:55:17.204506 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), 
renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
[0m20:55:17.209824 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m20:55:17.216514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:55:17.216833 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:55:17.218467 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:55:17.221581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:55:17.221833 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:55:17.223847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:55:17.244050 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:55:17.244360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:55:17.244568 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:55:17.246666 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m20:55:17.252374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:55:17.252671 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop view if exists "dbt"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m20:55:17.255624 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m20:55:17.257069 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-03-26 20:55:17.152031 => 2023-03-26 20:55:17.257015
[0m20:55:17.257328 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m20:55:17.258174 [info ] [Thread-1 (]: 1 of 3 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.11s]
[0m20:55:17.260190 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m20:55:17.260812 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m20:55:17.261384 [info ] [Thread-1 (]: 2 of 3 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m20:55:17.262297 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__orders'
[0m20:55:17.262602 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m20:55:17.266367 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m20:55:17.266973 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 2023-03-26 20:55:17.262786 => 2023-03-26 20:55:17.266914
[0m20:55:17.267248 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m20:55:17.271495 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m20:55:17.272029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:55:17.272251 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m20:55:17.272457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:17.280539 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:55:17.280897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:55:17.281154 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  create view "dbt"."warehouse"."stg_eltool__orders__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."warehouse"."orders"
),
renamed as (
    select order_id,
        cust_id AS customer_id,
        order_status,
        order_purchase_timestamp::TIMESTAMP,
        order_approved_at::TIMESTAMP,
        order_delivered_carrier_date::TIMESTAMP,
        order_delivered_customer_date::TIMESTAMP,
        order_estimated_delivery_date::TIMESTAMP
        from source
)
select *
from renamed
  );
[0m20:55:17.284314 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m20:55:17.287257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:55:17.287529 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:55:17.288839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:55:17.291544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:55:17.291805 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:55:17.293082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:55:17.295342 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:55:17.295667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:55:17.295891 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:55:17.297615 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m20:55:17.300161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:55:17.300445 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop view if exists "dbt"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m20:55:17.302500 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m20:55:17.303790 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 2023-03-26 20:55:17.267433 => 2023-03-26 20:55:17.303738
[0m20:55:17.304056 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m20:55:17.304813 [info ] [Thread-1 (]: 2 of 3 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.04s]
[0m20:55:17.305281 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m20:55:17.305638 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m20:55:17.306142 [info ] [Thread-1 (]: 3 of 3 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m20:55:17.306825 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__state'
[0m20:55:17.307204 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m20:55:17.309996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m20:55:17.310581 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 2023-03-26 20:55:17.307416 => 2023-03-26 20:55:17.310520
[0m20:55:17.310854 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m20:55:17.315224 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m20:55:17.315811 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:55:17.316048 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m20:55:17.316256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:55:17.323797 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:55:17.324134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:55:17.324355 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  create view "dbt"."warehouse"."stg_eltool__state__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."warehouse"."state"
),
renamed as (
    select state_identifier::INT AS state_id,
        state_code::VARCHAR(2) AS state_code,
        st_name::VARCHAR(30) AS state_name
    from source
)
select *
from renamed
  );
[0m20:55:17.327042 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m20:55:17.330472 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:55:17.330758 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:55:17.332507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:55:17.335623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:55:17.335950 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:55:17.338571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:55:17.340948 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:55:17.341417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:55:17.341701 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:55:17.344977 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m20:55:17.350277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:55:17.350684 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop view if exists "dbt"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m20:55:17.354038 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m20:55:17.355667 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 2023-03-26 20:55:17.311039 => 2023-03-26 20:55:17.355613
[0m20:55:17.355948 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m20:55:17.356917 [info ] [Thread-1 (]: 3 of 3 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.05s]
[0m20:55:17.357550 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m20:55:17.359351 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:55:17.359876 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:17.360434 [debug] [MainThread]: On master: BEGIN
[0m20:55:17.360698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:55:17.370262 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:55:17.370610 [debug] [MainThread]: On master: COMMIT
[0m20:55:17.370892 [debug] [MainThread]: Using postgres connection "master"
[0m20:55:17.371143 [debug] [MainThread]: On master: COMMIT
[0m20:55:17.372652 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:55:17.373123 [debug] [MainThread]: On master: Close
[0m20:55:17.373834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:55:17.374178 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__state' was properly closed.
[0m20:55:17.374583 [info ] [MainThread]: 
[0m20:55:17.375132 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m20:55:17.376043 [debug] [MainThread]: Command end result
[0m20:55:17.426071 [info ] [MainThread]: 
[0m20:55:17.426836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:55:17.427380 [info ] [MainThread]: 
[0m20:55:17.427870 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:55:17.428386 [debug] [MainThread]: Flushing usage events


============================== 2023-03-26 20:56:52.452561 | 8388b04c-d11c-4dcc-8b05-f7b316eaa839 ==============================
[0m20:56:52.452561 [info ] [MainThread]: Running with dbt=1.4.5
[0m20:56:52.455237 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m20:56:52.455585 [debug] [MainThread]: Tracking: do not track
[0m20:56:52.482737 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m20:56:52.492987 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:56:53.114304 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m20:56:53.127631 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
[0m20:56:53.130667 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
[0m20:56:53.258852 [info ] [MainThread]: Found 3 models, 7 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m20:56:53.260863 [info ] [MainThread]: 
[0m20:56:53.262882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:53.264022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m20:56:53.275298 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m20:56:53.275636 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m20:56:53.275916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:53.299611 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m20:56:53.301241 [debug] [ThreadPool]: On list_dbt: Close
[0m20:56:53.302883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse'
[0m20:56:53.309262 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m20:56:53.309624 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
[0m20:56:53.309909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:53.318693 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:56:53.319032 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m20:56:53.319271 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m20:56:53.322108 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m20:56:53.323505 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
[0m20:56:53.324491 [debug] [ThreadPool]: On list_dbt_warehouse: Close
[0m20:56:53.325363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m20:56:53.329737 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m20:56:53.330028 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m20:56:53.330260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:53.337494 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m20:56:53.337834 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m20:56:53.338073 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m20:56:53.340951 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m20:56:53.342222 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m20:56:53.343284 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m20:56:53.347993 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:53.348314 [debug] [MainThread]: On master: BEGIN
[0m20:56:53.348547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:53.355989 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:56:53.356318 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:53.356562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:56:53.369142 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m20:56:53.370839 [debug] [MainThread]: On master: ROLLBACK
[0m20:56:53.372286 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:53.372572 [debug] [MainThread]: On master: BEGIN
[0m20:56:53.374089 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:56:53.374442 [debug] [MainThread]: On master: COMMIT
[0m20:56:53.374695 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:53.374923 [debug] [MainThread]: On master: COMMIT
[0m20:56:53.375846 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:56:53.376159 [debug] [MainThread]: On master: Close
[0m20:56:53.376731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:53.377091 [info ] [MainThread]: 
[0m20:56:53.380458 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m20:56:53.380899 [info ] [Thread-1 (]: 1 of 3 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m20:56:53.381566 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m20:56:53.381843 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m20:56:53.384440 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m20:56:53.385082 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-03-26 20:56:53.382052 => 2023-03-26 20:56:53.384993
[0m20:56:53.385384 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m20:56:53.426711 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m20:56:53.427379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:56:53.427605 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m20:56:53.427810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:53.438124 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:56:53.438451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:56:53.438684 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  create view "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), 
renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
[0m20:56:53.442218 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m20:56:53.448833 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:56:53.449144 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m20:56:53.450686 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:56:53.453388 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:56:53.453647 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m20:56:53.455153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:56:53.474650 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:56:53.474966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:56:53.475189 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m20:56:53.479679 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m20:56:53.485290 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m20:56:53.485588 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop view if exists "dbt"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m20:56:53.488500 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m20:56:53.489849 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-03-26 20:56:53.385664 => 2023-03-26 20:56:53.489792
[0m20:56:53.490111 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m20:56:53.490877 [info ] [Thread-1 (]: 1 of 3 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.11s]
[0m20:56:53.492741 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m20:56:53.493193 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m20:56:53.493784 [info ] [Thread-1 (]: 2 of 3 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m20:56:53.494756 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__orders'
[0m20:56:53.495062 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m20:56:53.498825 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m20:56:53.499438 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 2023-03-26 20:56:53.495257 => 2023-03-26 20:56:53.499370
[0m20:56:53.499735 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m20:56:53.503973 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m20:56:53.504526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:56:53.504750 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m20:56:53.504954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:53.513205 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:56:53.513589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:56:53.513861 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  create view "dbt"."warehouse"."stg_eltool__orders__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."warehouse"."orders"
),
renamed as (
    select order_id,
        cust_id AS customer_id,
        order_status,
        order_purchase_timestamp::TIMESTAMP,
        order_approved_at::TIMESTAMP,
        order_delivered_carrier_date::TIMESTAMP,
        order_delivered_customer_date::TIMESTAMP,
        order_estimated_delivery_date::TIMESTAMP
        from source
)
select *
from renamed
  );
[0m20:56:53.517493 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m20:56:53.520348 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:56:53.520618 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m20:56:53.522039 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:56:53.524843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:56:53.525145 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m20:56:53.526859 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:56:53.528946 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:56:53.529194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:56:53.529396 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m20:56:53.531614 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m20:56:53.534191 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m20:56:53.534501 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop view if exists "dbt"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m20:56:53.536970 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m20:56:53.538529 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 2023-03-26 20:56:53.499921 => 2023-03-26 20:56:53.538479
[0m20:56:53.538793 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m20:56:53.539513 [info ] [Thread-1 (]: 2 of 3 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.05s]
[0m20:56:53.539952 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m20:56:53.540285 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m20:56:53.540677 [info ] [Thread-1 (]: 3 of 3 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m20:56:53.541307 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__state'
[0m20:56:53.541582 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m20:56:53.544354 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m20:56:53.544996 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 2023-03-26 20:56:53.541803 => 2023-03-26 20:56:53.544925
[0m20:56:53.545288 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m20:56:53.549695 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m20:56:53.550410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:56:53.550648 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m20:56:53.550853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:53.559762 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m20:56:53.560086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:56:53.560306 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  create view "dbt"."warehouse"."stg_eltool__state__dbt_tmp" as (
    with source as (
    select *
    from "dbt"."warehouse"."state"
),
renamed as (
    select state_identifier::INT AS state_id,
        state_code::VARCHAR(2) AS state_code,
        st_name::VARCHAR(30) AS state_name
    from source
)
select *
from renamed
  );
[0m20:56:53.562645 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0 seconds
[0m20:56:53.565670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:56:53.565961 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m20:56:53.567878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:56:53.570639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:56:53.570941 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m20:56:53.572438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m20:56:53.574510 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:56:53.574761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:56:53.575015 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m20:56:53.618504 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m20:56:53.625641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m20:56:53.626102 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop view if exists "dbt"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m20:56:53.629268 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m20:56:53.631024 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 2023-03-26 20:56:53.545477 => 2023-03-26 20:56:53.630952
[0m20:56:53.631395 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m20:56:53.632385 [info ] [Thread-1 (]: 3 of 3 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.09s]
[0m20:56:53.633136 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m20:56:53.634766 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:53.635286 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:53.635594 [debug] [MainThread]: On master: BEGIN
[0m20:56:53.635866 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:53.644433 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m20:56:53.644804 [debug] [MainThread]: On master: COMMIT
[0m20:56:53.645057 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:53.645290 [debug] [MainThread]: On master: COMMIT
[0m20:56:53.646298 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m20:56:53.646619 [debug] [MainThread]: On master: Close
[0m20:56:53.647177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:53.647421 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__state' was properly closed.
[0m20:56:53.647700 [info ] [MainThread]: 
[0m20:56:53.648039 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m20:56:53.648571 [debug] [MainThread]: Command end result
[0m20:56:53.695963 [info ] [MainThread]: 
[0m20:56:53.696589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:56:53.697036 [info ] [MainThread]: 
[0m20:56:53.697448 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:56:53.698008 [debug] [MainThread]: Flushing usage events


============================== 2023-03-26 21:10:08.711137 | 55716062-9899-4ecf-a405-200cd2b6613e ==============================
[0m21:10:08.711137 [info ] [MainThread]: Running with dbt=1.4.5
[0m21:10:08.714116 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m21:10:08.714408 [debug] [MainThread]: Tracking: do not track
[0m21:10:08.751790 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m21:10:08.762779 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:10:09.406618 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m21:10:09.420976 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
[0m21:10:09.424109 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
[0m21:10:09.552286 [info ] [MainThread]: Found 3 models, 7 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m21:10:09.554116 [info ] [MainThread]: 
[0m21:10:09.556496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:10:09.557720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m21:10:09.569208 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m21:10:09.569565 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m21:10:09.569834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:10:09.604043 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m21:10:09.605713 [debug] [ThreadPool]: On list_dbt: Close
[0m21:10:09.607480 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m21:10:09.614080 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m21:10:09.614398 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m21:10:09.614635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:10:09.623248 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m21:10:09.623591 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m21:10:09.623831 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m21:10:09.626748 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m21:10:09.628106 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m21:10:09.629428 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m21:10:09.630385 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse'
[0m21:10:09.634314 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m21:10:09.634623 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
[0m21:10:09.634855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:10:09.641959 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m21:10:09.642294 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m21:10:09.642537 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m21:10:09.645377 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m21:10:09.646736 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
[0m21:10:09.647670 [debug] [ThreadPool]: On list_dbt_warehouse: Close
[0m21:10:09.652713 [debug] [MainThread]: Using postgres connection "master"
[0m21:10:09.653043 [debug] [MainThread]: On master: BEGIN
[0m21:10:09.653284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:10:09.660308 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:10:09.660641 [debug] [MainThread]: Using postgres connection "master"
[0m21:10:09.660883 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:10:09.672716 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m21:10:09.674463 [debug] [MainThread]: On master: ROLLBACK
[0m21:10:09.675825 [debug] [MainThread]: Using postgres connection "master"
[0m21:10:09.676125 [debug] [MainThread]: On master: BEGIN
[0m21:10:09.677998 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:10:09.678330 [debug] [MainThread]: On master: COMMIT
[0m21:10:09.678578 [debug] [MainThread]: Using postgres connection "master"
[0m21:10:09.678803 [debug] [MainThread]: On master: COMMIT
[0m21:10:09.679858 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:10:09.680182 [debug] [MainThread]: On master: Close
[0m21:10:09.680766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:10:09.681127 [info ] [MainThread]: 
[0m21:10:09.686068 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m21:10:09.686528 [info ] [Thread-1 (]: 1 of 3 START sql table model warehouse.stg_eltool__customers ................... [RUN]
[0m21:10:09.687190 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m21:10:09.687521 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m21:10:09.690160 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m21:10:09.691125 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-03-26 21:10:09.687775 => 2023-03-26 21:10:09.691025
[0m21:10:09.691449 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m21:10:09.737263 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m21:10:09.737920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m21:10:09.738331 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m21:10:09.738626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:09.746701 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:10:09.747023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m21:10:09.747249 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  
    

  create  table "dbt"."warehouse"."stg_eltool__customers__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), 
renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
  
[0m21:10:09.753659 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0 seconds
[0m21:10:09.760057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m21:10:09.760336 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m21:10:09.761802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:10:09.764451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m21:10:09.764694 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m21:10:09.766357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:10:09.790724 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m21:10:09.791029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m21:10:09.791240 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m21:10:09.795078 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:10:09.800503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m21:10:09.800780 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop view if exists "dbt"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m21:10:09.803273 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m21:10:09.804694 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-03-26 21:10:09.691742 => 2023-03-26 21:10:09.804637
[0m21:10:09.804983 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m21:10:09.805776 [info ] [Thread-1 (]: 1 of 3 OK created sql table model warehouse.stg_eltool__customers .............. [[32mSELECT 100[0m in 0.12s]
[0m21:10:09.808979 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m21:10:09.809405 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m21:10:09.809903 [info ] [Thread-1 (]: 2 of 3 START sql table model warehouse.stg_eltool__orders ...................... [RUN]
[0m21:10:09.810585 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__orders'
[0m21:10:09.810919 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m21:10:09.813578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m21:10:09.814806 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 2023-03-26 21:10:09.811098 => 2023-03-26 21:10:09.814725
[0m21:10:09.815089 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m21:10:09.820064 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m21:10:09.820693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m21:10:09.820977 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m21:10:09.821286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:09.831891 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:10:09.832237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m21:10:09.832462 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  
    

  create  table "dbt"."warehouse"."stg_eltool__orders__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."warehouse"."orders"
),
renamed as (
    select order_id,
        cust_id AS customer_id,
        order_status,
        order_purchase_timestamp::TIMESTAMP,
        order_approved_at::TIMESTAMP,
        order_delivered_carrier_date::TIMESTAMP,
        order_delivered_customer_date::TIMESTAMP,
        order_estimated_delivery_date::TIMESTAMP
        from source
)
select *
from renamed
  );
  
[0m21:10:09.839955 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0 seconds
[0m21:10:09.842958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m21:10:09.843225 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m21:10:09.845188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:10:09.848026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m21:10:09.848303 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m21:10:09.849696 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:10:09.852075 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m21:10:09.852360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m21:10:09.852576 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m21:10:09.854445 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:10:09.856718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m21:10:09.856969 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop view if exists "dbt"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m21:10:09.859068 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m21:10:09.860361 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 2023-03-26 21:10:09.815267 => 2023-03-26 21:10:09.860308
[0m21:10:09.860626 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m21:10:09.861353 [info ] [Thread-1 (]: 2 of 3 OK created sql table model warehouse.stg_eltool__orders ................. [[32mSELECT 999[0m in 0.05s]
[0m21:10:09.861786 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m21:10:09.862125 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m21:10:09.862562 [info ] [Thread-1 (]: 3 of 3 START sql table model warehouse.stg_eltool__state ....................... [RUN]
[0m21:10:09.863277 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__state'
[0m21:10:09.863587 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m21:10:09.866249 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m21:10:09.866785 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 2023-03-26 21:10:09.863841 => 2023-03-26 21:10:09.866727
[0m21:10:09.867056 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m21:10:09.871491 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m21:10:09.872055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m21:10:09.872280 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m21:10:09.872494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:10:09.880984 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m21:10:09.881331 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m21:10:09.881562 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  
    

  create  table "dbt"."warehouse"."stg_eltool__state__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."warehouse"."state"
),
renamed as (
    select state_identifier::INT AS state_id,
        state_code::VARCHAR(2) AS state_code,
        st_name::VARCHAR(30) AS state_name
    from source
)
select *
from renamed
  );
  
[0m21:10:09.884148 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0 seconds
[0m21:10:09.887108 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m21:10:09.887380 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m21:10:09.889103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:10:09.892549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m21:10:09.892845 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m21:10:09.894319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m21:10:09.896818 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m21:10:09.897145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m21:10:09.897443 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m21:10:09.899103 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m21:10:09.902739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m21:10:09.903021 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop view if exists "dbt"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m21:10:09.905184 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0 seconds
[0m21:10:09.906649 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 2023-03-26 21:10:09.867242 => 2023-03-26 21:10:09.906595
[0m21:10:09.906921 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m21:10:09.907691 [info ] [Thread-1 (]: 3 of 3 OK created sql table model warehouse.stg_eltool__state .................. [[32mSELECT 27[0m in 0.04s]
[0m21:10:09.908171 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m21:10:09.909412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:10:09.909791 [debug] [MainThread]: Using postgres connection "master"
[0m21:10:09.910181 [debug] [MainThread]: On master: BEGIN
[0m21:10:09.910445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:10:09.917584 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m21:10:09.917941 [debug] [MainThread]: On master: COMMIT
[0m21:10:09.918187 [debug] [MainThread]: Using postgres connection "master"
[0m21:10:09.918415 [debug] [MainThread]: On master: COMMIT
[0m21:10:09.919360 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m21:10:09.919663 [debug] [MainThread]: On master: Close
[0m21:10:09.920204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:10:09.920440 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__state' was properly closed.
[0m21:10:09.920707 [info ] [MainThread]: 
[0m21:10:09.921046 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m21:10:09.921625 [debug] [MainThread]: Command end result
[0m21:10:09.928750 [info ] [MainThread]: 
[0m21:10:09.929245 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:10:09.930069 [info ] [MainThread]: 
[0m21:10:09.930855 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:10:09.931370 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 16:27:19.708858 | cf7880b3-acd2-4daf-ba97-f0b7aba1336f ==============================
[0m16:27:19.708858 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:27:19.713426 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:27:19.713917 [debug] [MainThread]: Tracking: do not track
[0m16:27:19.767184 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:27:19.853742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:27:19.854084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:27:19.873872 [info ] [MainThread]: Found 3 models, 7 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m16:27:19.876098 [info ] [MainThread]: 
[0m16:27:19.878573 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:27:19.880012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m16:27:19.895361 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m16:27:19.895840 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m16:27:19.896178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:27:20.103522 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m16:27:20.107387 [debug] [ThreadPool]: On list_dbt: Close
[0m16:27:20.111183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse'
[0m16:27:20.122557 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m16:27:20.122989 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
[0m16:27:20.123291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:20.143051 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:27:20.143607 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m16:27:20.143929 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m16:27:20.186175 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m16:27:20.188965 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
[0m16:27:20.192739 [debug] [ThreadPool]: On list_dbt_warehouse: Close
[0m16:27:20.194751 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m16:27:20.203411 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m16:27:20.204097 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m16:27:20.204565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:27:20.219577 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:27:20.220259 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m16:27:20.220710 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:27:20.227207 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:27:20.229580 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m16:27:20.234299 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m16:27:20.244999 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:20.246553 [debug] [MainThread]: On master: BEGIN
[0m16:27:20.247054 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:27:20.265482 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:27:20.265855 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:20.266133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:27:20.302242 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m16:27:20.304682 [debug] [MainThread]: On master: ROLLBACK
[0m16:27:20.306941 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:20.307354 [debug] [MainThread]: On master: BEGIN
[0m16:27:20.310834 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:27:20.311287 [debug] [MainThread]: On master: COMMIT
[0m16:27:20.311649 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:20.312218 [debug] [MainThread]: On master: COMMIT
[0m16:27:20.314943 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:27:20.315503 [debug] [MainThread]: On master: Close
[0m16:27:20.316408 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:27:20.316847 [info ] [MainThread]: 
[0m16:27:20.323153 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m16:27:20.323844 [info ] [Thread-1 (]: 1 of 3 START sql table model warehouse.stg_eltool__customers ................... [RUN]
[0m16:27:20.324621 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m16:27:20.325080 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m16:27:20.328748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m16:27:20.331047 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-04-05 16:27:20.325357 => 2023-04-05 16:27:20.330916
[0m16:27:20.331415 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m16:27:20.414767 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m16:27:20.418412 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m16:27:20.418993 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m16:27:20.419514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:20.461554 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:27:20.462313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m16:27:20.462740 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  
    

  create  table "dbt"."warehouse"."stg_eltool__customers__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), 
renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
  
[0m16:27:20.558308 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0 seconds
[0m16:27:20.571267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m16:27:20.572009 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m16:27:20.576181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m16:27:20.582394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m16:27:20.583175 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m16:27:20.585232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m16:27:20.632004 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m16:27:20.632381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m16:27:20.632631 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m16:27:20.634962 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m16:27:20.643432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m16:27:20.643761 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop table if exists "dbt"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m16:27:20.702266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m16:27:20.705131 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-04-05 16:27:20.331624 => 2023-04-05 16:27:20.705054
[0m16:27:20.705599 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m16:27:20.707322 [info ] [Thread-1 (]: 1 of 3 OK created sql table model warehouse.stg_eltool__customers .............. [[32mSELECT 100[0m in 0.38s]
[0m16:27:20.712479 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m16:27:20.713323 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m16:27:20.714365 [info ] [Thread-1 (]: 2 of 3 START sql table model warehouse.stg_eltool__orders ...................... [RUN]
[0m16:27:20.715626 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__orders'
[0m16:27:20.716031 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m16:27:20.720951 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m16:27:20.722374 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 2023-04-05 16:27:20.716281 => 2023-04-05 16:27:20.722289
[0m16:27:20.722839 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m16:27:20.729897 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m16:27:20.731004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m16:27:20.731318 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m16:27:20.731585 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:20.747056 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:27:20.747866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m16:27:20.748184 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  
    

  create  table "dbt"."warehouse"."stg_eltool__orders__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."warehouse"."orders"
),
renamed as (
    select order_id,
        cust_id AS customer_id,
        order_status,
        order_purchase_timestamp::TIMESTAMP,
        order_approved_at::TIMESTAMP,
        order_delivered_carrier_date::TIMESTAMP,
        order_delivered_customer_date::TIMESTAMP,
        order_estimated_delivery_date::TIMESTAMP
        from source
)
select *
from renamed
  );
  
[0m16:27:20.765589 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0 seconds
[0m16:27:20.769858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m16:27:20.770356 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m16:27:20.773549 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m16:27:20.779583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m16:27:20.780219 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m16:27:20.782556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m16:27:20.790760 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m16:27:20.791255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m16:27:20.791576 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m16:27:20.796567 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m16:27:20.801406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m16:27:20.801870 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop table if exists "dbt"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m16:27:20.809611 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m16:27:20.814101 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 2023-04-05 16:27:20.723095 => 2023-04-05 16:27:20.813908
[0m16:27:20.814706 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m16:27:20.816745 [info ] [Thread-1 (]: 2 of 3 OK created sql table model warehouse.stg_eltool__orders ................. [[32mSELECT 999[0m in 0.10s]
[0m16:27:20.818062 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m16:27:20.819185 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m16:27:20.820310 [info ] [Thread-1 (]: 3 of 3 START sql table model warehouse.stg_eltool__state ....................... [RUN]
[0m16:27:20.822344 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__state'
[0m16:27:20.823142 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m16:27:20.830852 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m16:27:20.831992 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 2023-04-05 16:27:20.823559 => 2023-04-05 16:27:20.831824
[0m16:27:20.832460 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m16:27:20.843217 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m16:27:20.844365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m16:27:20.844988 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m16:27:20.845594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:27:20.873745 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m16:27:20.874486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m16:27:20.874920 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  
    

  create  table "dbt"."warehouse"."stg_eltool__state__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."warehouse"."state"
),
renamed as (
    select state_identifier::INT AS state_id,
        state_code::VARCHAR(2) AS state_code,
        st_name::VARCHAR(30) AS state_name
    from source
)
select *
from renamed
  );
  
[0m16:27:20.883624 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0 seconds
[0m16:27:20.888509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m16:27:20.888925 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m16:27:20.891776 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m16:27:20.897028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m16:27:20.897534 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m16:27:20.899719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m16:27:20.904269 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m16:27:20.904716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m16:27:20.905138 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m16:27:20.908355 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m16:27:20.912838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m16:27:20.913496 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop table if exists "dbt"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m16:27:20.919840 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m16:27:20.922256 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 2023-04-05 16:27:20.832955 => 2023-04-05 16:27:20.922184
[0m16:27:20.922615 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m16:27:20.923727 [info ] [Thread-1 (]: 3 of 3 OK created sql table model warehouse.stg_eltool__state .................. [[32mSELECT 27[0m in 0.10s]
[0m16:27:20.924347 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m16:27:20.925920 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:27:20.926418 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:20.926840 [debug] [MainThread]: On master: BEGIN
[0m16:27:20.927194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:27:20.941489 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:27:20.942319 [debug] [MainThread]: On master: COMMIT
[0m16:27:20.942790 [debug] [MainThread]: Using postgres connection "master"
[0m16:27:20.943133 [debug] [MainThread]: On master: COMMIT
[0m16:27:20.945334 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:27:20.945779 [debug] [MainThread]: On master: Close
[0m16:27:20.947124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:27:20.947695 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__state' was properly closed.
[0m16:27:20.948202 [info ] [MainThread]: 
[0m16:27:20.948839 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m16:27:20.950104 [debug] [MainThread]: Command end result
[0m16:27:20.964466 [info ] [MainThread]: 
[0m16:27:20.965536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:27:20.966314 [info ] [MainThread]: 
[0m16:27:20.967217 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:27:20.967999 [debug] [MainThread]: Flushing usage events


============================== 2023-04-05 22:27:42.013318 | 135dcfa2-b130-4db1-aa17-e98c29c35473 ==============================
[0m22:27:42.013318 [info ] [MainThread]: Running with dbt=1.4.5
[0m22:27:42.016065 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m22:27:42.016400 [debug] [MainThread]: Tracking: do not track
[0m22:27:42.050570 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m22:27:42.064032 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:27:42.778084 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m22:27:42.791829 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
[0m22:27:42.794930 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
[0m22:27:42.936337 [info ] [MainThread]: Found 3 models, 7 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m22:27:42.938659 [info ] [MainThread]: 
[0m22:27:42.941276 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:27:42.942364 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m22:27:42.954508 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m22:27:42.954859 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m22:27:42.955123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:42.992286 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:27:42.992692 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m22:27:42.992938 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m22:27:43.007585 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m22:27:43.009438 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m22:27:43.011530 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m22:27:43.012822 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse'
[0m22:27:43.017755 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m22:27:43.018280 [debug] [ThreadPool]: On list_dbt_warehouse: BEGIN
[0m22:27:43.018704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:27:43.026919 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:27:43.027260 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse"
[0m22:27:43.027507 [debug] [ThreadPool]: On list_dbt_warehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
  
[0m22:27:43.031507 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m22:27:43.032885 [debug] [ThreadPool]: On list_dbt_warehouse: ROLLBACK
[0m22:27:43.034375 [debug] [ThreadPool]: On list_dbt_warehouse: Close
[0m22:27:43.040082 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:43.040566 [debug] [MainThread]: On master: BEGIN
[0m22:27:43.040837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:27:43.050873 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m22:27:43.051222 [debug] [MainThread]: Using postgres connection "master"
[0m22:27:43.051473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:27:43.066848 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m22:27:43.068493 [debug] [MainThread]: On master: ROLLBACK
[0m22:27:43.070065 [debug] [MainThread]: On master: Close
[0m22:27:43.070780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:27:43.071262 [info ] [MainThread]: 
[0m22:27:43.075630 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m22:27:43.076262 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__orders'
[0m22:27:43.076550 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m22:27:43.079658 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m22:27:43.080677 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 2023-04-05 22:27:43.076792 => 2023-04-05 22:27:43.080585
[0m22:27:43.081022 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m22:27:43.081314 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 2023-04-05 22:27:43.081239 => 2023-04-05 22:27:43.081264
[0m22:27:43.083403 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m22:27:43.083821 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m22:27:43.084629 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__state'
[0m22:27:43.084933 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m22:27:43.087405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m22:27:43.087972 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 2023-04-05 22:27:43.085123 => 2023-04-05 22:27:43.087909
[0m22:27:43.088250 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m22:27:43.088493 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 2023-04-05 22:27:43.088440 => 2023-04-05 22:27:43.088450
[0m22:27:43.089189 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m22:27:43.089678 [debug] [Thread-1 (]: Began running node snapshot.dbt_project.customers_snapshot
[0m22:27:43.090716 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_project.customers_snapshot'
[0m22:27:43.091185 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_project.customers_snapshot
[0m22:27:43.095651 [debug] [Thread-1 (]: Timing info for snapshot.dbt_project.customers_snapshot (compile): 2023-04-05 22:27:43.091664 => 2023-04-05 22:27:43.095545
[0m22:27:43.096171 [debug] [Thread-1 (]: Began executing node snapshot.dbt_project.customers_snapshot
[0m22:27:43.096618 [debug] [Thread-1 (]: Timing info for snapshot.dbt_project.customers_snapshot (execute): 2023-04-05 22:27:43.096473 => 2023-04-05 22:27:43.096483
[0m22:27:43.097409 [debug] [Thread-1 (]: Finished running node snapshot.dbt_project.customers_snapshot
[0m22:27:43.097911 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:27:43.098979 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.source_not_null_warehouse_customers_customer_id.ae7452c4c6'
[0m22:27:43.099266 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:27:43.110385 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m22:27:43.111241 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 2023-04-05 22:27:43.099447 => 2023-04-05 22:27:43.111156
[0m22:27:43.111574 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:27:43.111831 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 2023-04-05 22:27:43.111761 => 2023-04-05 22:27:43.111770
[0m22:27:43.112458 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:27:43.112818 [debug] [Thread-1 (]: Began running node test.dbt_project.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:27:43.113505 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.source_not_null_warehouse_orders_order_id.c85a1f0b76'
[0m22:27:43.113765 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:27:43.118415 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m22:27:43.119022 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 2023-04-05 22:27:43.113944 => 2023-04-05 22:27:43.118919
[0m22:27:43.119332 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:27:43.119564 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 2023-04-05 22:27:43.119514 => 2023-04-05 22:27:43.119523
[0m22:27:43.120177 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:27:43.120511 [debug] [Thread-1 (]: Began running node test.dbt_project.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:27:43.121394 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2'
[0m22:27:43.121972 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:27:43.130112 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m22:27:43.130797 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 2023-04-05 22:27:43.122432 => 2023-04-05 22:27:43.130715
[0m22:27:43.131212 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:27:43.131547 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 2023-04-05 22:27:43.131477 => 2023-04-05 22:27:43.131489
[0m22:27:43.132259 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:27:43.132669 [debug] [Thread-1 (]: Began running node test.dbt_project.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:27:43.133540 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.source_unique_warehouse_orders_order_id.839fb43d0f'
[0m22:27:43.134092 [debug] [Thread-1 (]: Began compiling node test.dbt_project.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:27:43.142137 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m22:27:43.142737 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 2023-04-05 22:27:43.134512 => 2023-04-05 22:27:43.142644
[0m22:27:43.143111 [debug] [Thread-1 (]: Began executing node test.dbt_project.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:27:43.143446 [debug] [Thread-1 (]: Timing info for test.dbt_project.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 2023-04-05 22:27:43.143377 => 2023-04-05 22:27:43.143388
[0m22:27:43.144265 [debug] [Thread-1 (]: Finished running node test.dbt_project.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:27:43.144615 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__orders_order_id.9c268e2f6b
[0m22:27:43.145201 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_eltool__orders_order_id.9c268e2f6b'
[0m22:27:43.145490 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__orders_order_id.9c268e2f6b
[0m22:27:43.152062 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__orders_order_id.9c268e2f6b"
[0m22:27:43.152739 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__orders_order_id.9c268e2f6b (compile): 2023-04-05 22:27:43.145676 => 2023-04-05 22:27:43.152669
[0m22:27:43.153164 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__orders_order_id.9c268e2f6b
[0m22:27:43.153407 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__orders_order_id.9c268e2f6b (execute): 2023-04-05 22:27:43.153354 => 2023-04-05 22:27:43.153363
[0m22:27:43.154059 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__orders_order_id.9c268e2f6b
[0m22:27:43.154458 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__state_state_identifier.c4ef95a6e5
[0m22:27:43.155074 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_eltool__state_state_identifier.c4ef95a6e5'
[0m22:27:43.155343 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__state_state_identifier.c4ef95a6e5
[0m22:27:43.159373 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__state_state_identifier.c4ef95a6e5"
[0m22:27:43.159938 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__state_state_identifier.c4ef95a6e5 (compile): 2023-04-05 22:27:43.155521 => 2023-04-05 22:27:43.159859
[0m22:27:43.160210 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__state_state_identifier.c4ef95a6e5
[0m22:27:43.160532 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__state_state_identifier.c4ef95a6e5 (execute): 2023-04-05 22:27:43.160474 => 2023-04-05 22:27:43.160484
[0m22:27:43.161203 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__state_state_identifier.c4ef95a6e5
[0m22:27:43.161531 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m22:27:43.162088 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m22:27:43.162350 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m22:27:43.164822 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m22:27:43.165700 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-04-05 22:27:43.162530 => 2023-04-05 22:27:43.165590
[0m22:27:43.166039 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m22:27:43.166293 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-04-05 22:27:43.166236 => 2023-04-05 22:27:43.166246
[0m22:27:43.167140 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m22:27:43.168570 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_eltool__customers_customer_id.4bd58324df
[0m22:27:43.169395 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_eltool__customers_customer_id.4bd58324df'
[0m22:27:43.169757 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_eltool__customers_customer_id.4bd58324df
[0m22:27:43.174412 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_eltool__customers_customer_id.4bd58324df"
[0m22:27:43.174959 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__customers_customer_id.4bd58324df (compile): 2023-04-05 22:27:43.170221 => 2023-04-05 22:27:43.174899
[0m22:27:43.175267 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_eltool__customers_customer_id.4bd58324df
[0m22:27:43.175493 [debug] [Thread-1 (]: Timing info for test.dbt_project.not_null_stg_eltool__customers_customer_id.4bd58324df (execute): 2023-04-05 22:27:43.175446 => 2023-04-05 22:27:43.175455
[0m22:27:43.176079 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_eltool__customers_customer_id.4bd58324df
[0m22:27:43.177151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:43.177405 [debug] [MainThread]: Connection 'test.dbt_project.not_null_stg_eltool__customers_customer_id.4bd58324df' was properly closed.
[0m22:27:43.178093 [debug] [MainThread]: Command end result
[0m22:27:43.185067 [info ] [MainThread]: Done.
[0m22:27:43.188782 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m22:27:43.189095 [info ] [MainThread]: Building catalog
[0m22:27:43.191477 [debug] [ThreadPool]: Acquiring new postgres connection 'dbt.information_schema'
[0m22:27:43.199868 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
[0m22:27:43.200256 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m22:27:43.200605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:43.209959 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m22:27:43.210388 [debug] [ThreadPool]: Using postgres connection "dbt.information_schema"
[0m22:27:43.210668 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "dbt.information_schema"} */

    
    

    select
        'dbt' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('warehouse') or upper(sch.nspname) = upper('snapshots'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:27:43.243753 [debug] [ThreadPool]: SQL status: SELECT 27 in 0 seconds
[0m22:27:43.257228 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m22:27:43.259468 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m22:27:43.275050 [info ] [MainThread]: Catalog written to /Users/renekesenheimer/Projects/dbt_setup/dbt_project/target/catalog.json
[0m22:27:43.275697 [debug] [MainThread]: Flushing usage events
[0m22:27:43.276039 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:27:43.276325 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.


============================== 2023-04-06 08:42:24.830026 | 8052879e-a1b6-4def-a86f-3d398a002c5a ==============================
[0m08:42:24.830026 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:42:24.832605 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:42:24.832909 [debug] [MainThread]: Tracking: do not track
[0m08:42:24.864329 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:42:24.875718 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:42:25.532896 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m08:42:25.546708 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
[0m08:42:25.549885 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
[0m08:42:25.687004 [info ] [MainThread]: Found 3 models, 7 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m08:42:25.689069 [info ] [MainThread]: 
[0m08:42:25.691062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:42:25.692202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m08:42:25.703231 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m08:42:25.703580 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m08:42:25.703873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:42:25.737519 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m08:42:25.739538 [debug] [ThreadPool]: On list_dbt: Close
[0m08:42:25.740879 [debug] [ThreadPool]: Acquiring new postgres connection 'create_dbt_warehouse_staging'
[0m08:42:25.741489 [debug] [ThreadPool]: Acquiring new postgres connection 'create_dbt_warehouse_staging'
[0m08:42:25.741886 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='dbt', schema='warehouse_staging', identifier=None)"
[0m08:42:25.749278 [debug] [ThreadPool]: Using postgres connection "create_dbt_warehouse_staging"
[0m08:42:25.749714 [debug] [ThreadPool]: On create_dbt_warehouse_staging: BEGIN
[0m08:42:25.750316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:25.761458 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:42:25.761920 [debug] [ThreadPool]: Using postgres connection "create_dbt_warehouse_staging"
[0m08:42:25.762206 [debug] [ThreadPool]: On create_dbt_warehouse_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "create_dbt_warehouse_staging"} */
create schema if not exists "warehouse_staging"
[0m08:42:25.764502 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0 seconds
[0m08:42:25.765855 [debug] [ThreadPool]: On create_dbt_warehouse_staging: COMMIT
[0m08:42:25.766202 [debug] [ThreadPool]: Using postgres connection "create_dbt_warehouse_staging"
[0m08:42:25.766443 [debug] [ThreadPool]: On create_dbt_warehouse_staging: COMMIT
[0m08:42:25.768571 [debug] [ThreadPool]: SQL status: COMMIT in 0 seconds
[0m08:42:25.768925 [debug] [ThreadPool]: On create_dbt_warehouse_staging: Close
[0m08:42:25.770673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m08:42:25.777593 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m08:42:25.778136 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m08:42:25.778418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:25.787513 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:42:25.787861 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m08:42:25.788157 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m08:42:25.791345 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m08:42:25.792637 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m08:42:25.793751 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m08:42:25.794717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse_staging'
[0m08:42:25.798426 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse_staging"
[0m08:42:25.798719 [debug] [ThreadPool]: On list_dbt_warehouse_staging: BEGIN
[0m08:42:25.798950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:42:25.829687 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:42:25.830028 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse_staging"
[0m08:42:25.830269 [debug] [ThreadPool]: On list_dbt_warehouse_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse_staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse_staging'
  
[0m08:42:25.833283 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m08:42:25.834483 [debug] [ThreadPool]: On list_dbt_warehouse_staging: ROLLBACK
[0m08:42:25.835578 [debug] [ThreadPool]: On list_dbt_warehouse_staging: Close
[0m08:42:25.840279 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:25.840592 [debug] [MainThread]: On master: BEGIN
[0m08:42:25.840824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:42:25.848862 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:42:25.849211 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:25.849460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:42:25.858682 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m08:42:25.860394 [debug] [MainThread]: On master: ROLLBACK
[0m08:42:25.861787 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:25.862078 [debug] [MainThread]: On master: BEGIN
[0m08:42:25.863976 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:42:25.864282 [debug] [MainThread]: On master: COMMIT
[0m08:42:25.864524 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:25.864745 [debug] [MainThread]: On master: COMMIT
[0m08:42:25.866101 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:42:25.866533 [debug] [MainThread]: On master: Close
[0m08:42:25.867257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:42:25.867685 [info ] [MainThread]: 
[0m08:42:25.871896 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m08:42:25.872346 [info ] [Thread-1 (]: 1 of 3 START sql table model warehouse_staging.stg_eltool__customers ........... [RUN]
[0m08:42:25.873067 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m08:42:25.873339 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m08:42:25.875883 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m08:42:25.876564 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-04-06 08:42:25.873574 => 2023-04-06 08:42:25.876470
[0m08:42:25.876868 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m08:42:25.923659 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m08:42:25.924624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m08:42:25.924960 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m08:42:25.925200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:42:25.949691 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:42:25.950048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m08:42:25.950276 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  
    

  create  table "dbt"."warehouse_staging"."stg_eltool__customers__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), 
renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
  
[0m08:42:25.970809 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0 seconds
[0m08:42:25.977281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m08:42:25.977569 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse_staging"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m08:42:25.980115 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:42:26.001176 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m08:42:26.001502 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m08:42:26.001717 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m08:42:26.004172 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:42:26.010884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m08:42:26.011196 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop table if exists "dbt"."warehouse_staging"."stg_eltool__customers__dbt_backup" cascade
[0m08:42:26.012496 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:42:26.013793 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-04-06 08:42:25.877061 => 2023-04-06 08:42:26.013738
[0m08:42:26.014052 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m08:42:26.014810 [info ] [Thread-1 (]: 1 of 3 OK created sql table model warehouse_staging.stg_eltool__customers ...... [[32mSELECT 100[0m in 0.14s]
[0m08:42:26.016702 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m08:42:26.017326 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m08:42:26.017865 [info ] [Thread-1 (]: 2 of 3 START sql table model warehouse_staging.stg_eltool__orders .............. [RUN]
[0m08:42:26.018542 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__orders'
[0m08:42:26.018822 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m08:42:26.058260 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m08:42:26.059714 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 2023-04-06 08:42:26.019016 => 2023-04-06 08:42:26.059625
[0m08:42:26.060085 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m08:42:26.065436 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m08:42:26.066433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m08:42:26.066742 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m08:42:26.067138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:42:26.077552 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:42:26.077976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m08:42:26.078235 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  
    

  create  table "dbt"."warehouse_staging"."stg_eltool__orders__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."warehouse"."orders"
),
renamed as (
    select order_id,
        cust_id AS customer_id,
        order_status,
        order_purchase_timestamp::TIMESTAMP,
        order_approved_at::TIMESTAMP,
        order_delivered_carrier_date::TIMESTAMP,
        order_delivered_customer_date::TIMESTAMP,
        order_estimated_delivery_date::TIMESTAMP
        from source
)
select *
from renamed
  );
  
[0m08:42:26.100900 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0 seconds
[0m08:42:26.103950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m08:42:26.104256 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse_staging"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m08:42:26.105736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:42:26.107862 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m08:42:26.108120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m08:42:26.108329 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m08:42:26.110225 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:42:26.112866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m08:42:26.113151 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop table if exists "dbt"."warehouse_staging"."stg_eltool__orders__dbt_backup" cascade
[0m08:42:26.114435 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:42:26.115688 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 2023-04-06 08:42:26.060301 => 2023-04-06 08:42:26.115634
[0m08:42:26.115954 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m08:42:26.116727 [info ] [Thread-1 (]: 2 of 3 OK created sql table model warehouse_staging.stg_eltool__orders ......... [[32mSELECT 999[0m in 0.10s]
[0m08:42:26.117341 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m08:42:26.117775 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m08:42:26.118187 [info ] [Thread-1 (]: 3 of 3 START sql table model warehouse_staging.stg_eltool__state ............... [RUN]
[0m08:42:26.118894 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__state'
[0m08:42:26.119211 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m08:42:26.121954 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m08:42:26.122582 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 2023-04-06 08:42:26.119413 => 2023-04-06 08:42:26.122503
[0m08:42:26.122868 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m08:42:26.127019 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m08:42:26.127596 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m08:42:26.127928 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m08:42:26.128175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:42:26.137733 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:42:26.159510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m08:42:26.159910 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  
    

  create  table "dbt"."warehouse_staging"."stg_eltool__state__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."warehouse"."state"
),
renamed as (
    select state_identifier::INT AS state_id,
        state_code::VARCHAR(2) AS state_code,
        st_name::VARCHAR(30) AS state_name
    from source
)
select *
from renamed
  );
  
[0m08:42:26.166963 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0 seconds
[0m08:42:26.170328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m08:42:26.170631 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse_staging"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m08:42:26.172159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:42:26.174262 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m08:42:26.174575 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m08:42:26.174783 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m08:42:26.176856 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:42:26.179341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m08:42:26.179690 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop table if exists "dbt"."warehouse_staging"."stg_eltool__state__dbt_backup" cascade
[0m08:42:26.181504 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:42:26.183315 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 2023-04-06 08:42:26.123055 => 2023-04-06 08:42:26.183195
[0m08:42:26.183681 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m08:42:26.184754 [info ] [Thread-1 (]: 3 of 3 OK created sql table model warehouse_staging.stg_eltool__state .......... [[32mSELECT 27[0m in 0.07s]
[0m08:42:26.185603 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m08:42:26.187539 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:42:26.188086 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:26.188412 [debug] [MainThread]: On master: BEGIN
[0m08:42:26.188849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:42:26.200638 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:42:26.201133 [debug] [MainThread]: On master: COMMIT
[0m08:42:26.201438 [debug] [MainThread]: Using postgres connection "master"
[0m08:42:26.201726 [debug] [MainThread]: On master: COMMIT
[0m08:42:26.203209 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:42:26.203549 [debug] [MainThread]: On master: Close
[0m08:42:26.204127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:42:26.204382 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__state' was properly closed.
[0m08:42:26.204656 [info ] [MainThread]: 
[0m08:42:26.204984 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m08:42:26.205479 [debug] [MainThread]: Command end result
[0m08:42:26.213667 [info ] [MainThread]: 
[0m08:42:26.214214 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:42:26.214740 [info ] [MainThread]: 
[0m08:42:26.215226 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:42:26.215701 [debug] [MainThread]: Flushing usage events


============================== 2023-04-06 08:45:08.864127 | 24d0b197-f8f0-47bb-a246-effdbfba068c ==============================
[0m08:45:08.864127 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:45:08.866798 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/renekesenheimer/Projects/dbt_setup', 'send_anonymous_usage_stats': False, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:45:08.867369 [debug] [MainThread]: Tracking: do not track
[0m08:45:08.897087 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:45:08.907693 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:45:09.561700 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m08:45:09.575113 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
[0m08:45:09.578512 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
[0m08:45:09.707400 [info ] [MainThread]: Found 3 models, 7 tests, 1 snapshot, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m08:45:09.709603 [info ] [MainThread]: 
[0m08:45:09.711849 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:09.713019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt'
[0m08:45:09.724504 [debug] [ThreadPool]: Using postgres connection "list_dbt"
[0m08:45:09.724863 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt"} */

    select distinct nspname from pg_namespace
  
[0m08:45:09.725136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:09.759560 [debug] [ThreadPool]: SQL status: SELECT 8 in 0 seconds
[0m08:45:09.761802 [debug] [ThreadPool]: On list_dbt: Close
[0m08:45:09.763886 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_snapshots'
[0m08:45:09.771495 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m08:45:09.771816 [debug] [ThreadPool]: On list_dbt_snapshots: BEGIN
[0m08:45:09.772080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.786496 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:45:09.786862 [debug] [ThreadPool]: Using postgres connection "list_dbt_snapshots"
[0m08:45:09.787124 [debug] [ThreadPool]: On list_dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_snapshots"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m08:45:09.790614 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m08:45:09.791973 [debug] [ThreadPool]: On list_dbt_snapshots: ROLLBACK
[0m08:45:09.793529 [debug] [ThreadPool]: On list_dbt_snapshots: Close
[0m08:45:09.794836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dbt_warehouse_staging'
[0m08:45:09.798969 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse_staging"
[0m08:45:09.799279 [debug] [ThreadPool]: On list_dbt_warehouse_staging: BEGIN
[0m08:45:09.799617 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:09.807668 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m08:45:09.808041 [debug] [ThreadPool]: Using postgres connection "list_dbt_warehouse_staging"
[0m08:45:09.808297 [debug] [ThreadPool]: On list_dbt_warehouse_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "list_dbt_warehouse_staging"} */
select
      'dbt' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse_staging'
    union all
    select
      'dbt' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse_staging'
  
[0m08:45:09.811611 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m08:45:09.812928 [debug] [ThreadPool]: On list_dbt_warehouse_staging: ROLLBACK
[0m08:45:09.814076 [debug] [ThreadPool]: On list_dbt_warehouse_staging: Close
[0m08:45:09.818926 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:09.819237 [debug] [MainThread]: On master: BEGIN
[0m08:45:09.819476 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:09.828551 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:45:09.828886 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:09.829127 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:09.854014 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m08:45:09.855259 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:09.857010 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:09.857334 [debug] [MainThread]: On master: BEGIN
[0m08:45:09.859357 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:45:09.859686 [debug] [MainThread]: On master: COMMIT
[0m08:45:09.859940 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:09.860168 [debug] [MainThread]: On master: COMMIT
[0m08:45:09.861313 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:45:09.861600 [debug] [MainThread]: On master: Close
[0m08:45:09.862187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:45:09.862590 [info ] [MainThread]: 
[0m08:45:09.867023 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__customers
[0m08:45:09.867457 [info ] [Thread-1 (]: 1 of 3 START sql table model warehouse_staging.stg_eltool__customers ........... [RUN]
[0m08:45:09.868115 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__customers'
[0m08:45:09.868415 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__customers
[0m08:45:09.870908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__customers"
[0m08:45:09.871467 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (compile): 2023-04-06 08:45:09.868631 => 2023-04-06 08:45:09.871390
[0m08:45:09.871752 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__customers
[0m08:45:09.916930 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__customers"
[0m08:45:09.917981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m08:45:09.918226 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: BEGIN
[0m08:45:09.918440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:09.930185 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:45:09.930531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m08:45:09.930748 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */

  
    

  create  table "dbt"."warehouse_staging"."stg_eltool__customers__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."snapshots"."customers_snapshot"
), 
renamed as (
    select customer_id,
        zipcode,
        city,
        state_code,
        datetime_created::TIMESTAMP AS datetime_created,
        datetime_updated::TIMESTAMP AS datetime_updated,
        dbt_valid_from,
        dbt_valid_to
    from source
)
select *
from renamed
  );
  
[0m08:45:09.940415 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0 seconds
[0m08:45:09.947091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m08:45:09.947393 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse_staging"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m08:45:09.949526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:45:09.952505 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m08:45:09.952773 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
alter table "dbt"."warehouse_staging"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m08:45:09.954512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:45:09.978313 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m08:45:09.978623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m08:45:09.978839 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: COMMIT
[0m08:45:09.982675 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:45:09.988012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__customers"
[0m08:45:09.988297 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__customers"} */
drop table if exists "dbt"."warehouse_staging"."stg_eltool__customers__dbt_backup" cascade
[0m08:45:09.995565 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:45:09.996917 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__customers (execute): 2023-04-06 08:45:09.871939 => 2023-04-06 08:45:09.996861
[0m08:45:09.997188 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__customers: Close
[0m08:45:09.997977 [info ] [Thread-1 (]: 1 of 3 OK created sql table model warehouse_staging.stg_eltool__customers ...... [[32mSELECT 100[0m in 0.13s]
[0m08:45:10.001246 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__customers
[0m08:45:10.001677 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__orders
[0m08:45:10.002085 [info ] [Thread-1 (]: 2 of 3 START sql table model warehouse_staging.stg_eltool__orders .............. [RUN]
[0m08:45:10.002720 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__orders'
[0m08:45:10.002992 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__orders
[0m08:45:10.005452 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__orders"
[0m08:45:10.006086 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (compile): 2023-04-06 08:45:10.003178 => 2023-04-06 08:45:10.006011
[0m08:45:10.006474 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__orders
[0m08:45:10.011245 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__orders"
[0m08:45:10.011801 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m08:45:10.012035 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: BEGIN
[0m08:45:10.012244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:10.022419 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:45:10.022842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m08:45:10.023096 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */

  
    

  create  table "dbt"."warehouse_staging"."stg_eltool__orders__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."warehouse"."orders"
),
renamed as (
    select order_id,
        cust_id AS customer_id,
        order_status,
        order_purchase_timestamp::TIMESTAMP,
        order_approved_at::TIMESTAMP,
        order_delivered_carrier_date::TIMESTAMP,
        order_delivered_customer_date::TIMESTAMP,
        order_estimated_delivery_date::TIMESTAMP
        from source
)
select *
from renamed
  );
  
[0m08:45:10.032113 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0 seconds
[0m08:45:10.034832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m08:45:10.035106 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse_staging"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m08:45:10.036892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:45:10.039603 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m08:45:10.039967 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
alter table "dbt"."warehouse_staging"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m08:45:10.042366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:45:10.045326 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m08:45:10.045619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m08:45:10.045828 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: COMMIT
[0m08:45:10.049631 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:45:10.052174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__orders"
[0m08:45:10.052484 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__orders"} */
drop table if exists "dbt"."warehouse_staging"."stg_eltool__orders__dbt_backup" cascade
[0m08:45:10.057159 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:45:10.058469 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__orders (execute): 2023-04-06 08:45:10.006855 => 2023-04-06 08:45:10.058416
[0m08:45:10.058849 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__orders: Close
[0m08:45:10.060203 [info ] [Thread-1 (]: 2 of 3 OK created sql table model warehouse_staging.stg_eltool__orders ......... [[32mSELECT 999[0m in 0.06s]
[0m08:45:10.061447 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__orders
[0m08:45:10.062077 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_eltool__state
[0m08:45:10.062750 [info ] [Thread-1 (]: 3 of 3 START sql table model warehouse_staging.stg_eltool__state ............... [RUN]
[0m08:45:10.063974 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_eltool__state'
[0m08:45:10.064561 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_eltool__state
[0m08:45:10.069223 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_eltool__state"
[0m08:45:10.070097 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (compile): 2023-04-06 08:45:10.064901 => 2023-04-06 08:45:10.069916
[0m08:45:10.070465 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_eltool__state
[0m08:45:10.075337 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_eltool__state"
[0m08:45:10.076402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m08:45:10.076802 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: BEGIN
[0m08:45:10.077119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:45:10.086123 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m08:45:10.086491 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m08:45:10.086756 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */

  
    

  create  table "dbt"."warehouse_staging"."stg_eltool__state__dbt_tmp"
  as (
    with source as (
    select *
    from "dbt"."warehouse"."state"
),
renamed as (
    select state_identifier::INT AS state_id,
        state_code::VARCHAR(2) AS state_code,
        st_name::VARCHAR(30) AS state_name
    from source
)
select *
from renamed
  );
  
[0m08:45:10.090831 [debug] [Thread-1 (]: SQL status: SELECT 27 in 0 seconds
[0m08:45:10.093784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m08:45:10.094082 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse_staging"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m08:45:10.096148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:45:10.099117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m08:45:10.099421 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
alter table "dbt"."warehouse_staging"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m08:45:10.100783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m08:45:10.103179 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m08:45:10.103752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m08:45:10.104159 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: COMMIT
[0m08:45:10.106958 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m08:45:10.111202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_eltool__state"
[0m08:45:10.111506 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "dbt_profile", "target_name": "dev", "node_id": "model.dbt_project.stg_eltool__state"} */
drop table if exists "dbt"."warehouse_staging"."stg_eltool__state__dbt_backup" cascade
[0m08:45:10.116633 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m08:45:10.157796 [debug] [Thread-1 (]: Timing info for model.dbt_project.stg_eltool__state (execute): 2023-04-06 08:45:10.070685 => 2023-04-06 08:45:10.157727
[0m08:45:10.158211 [debug] [Thread-1 (]: On model.dbt_project.stg_eltool__state: Close
[0m08:45:10.159207 [info ] [Thread-1 (]: 3 of 3 OK created sql table model warehouse_staging.stg_eltool__state .......... [[32mSELECT 27[0m in 0.10s]
[0m08:45:10.159880 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_eltool__state
[0m08:45:10.161684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:10.162185 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:10.162808 [debug] [MainThread]: On master: BEGIN
[0m08:45:10.163155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:10.173202 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m08:45:10.173602 [debug] [MainThread]: On master: COMMIT
[0m08:45:10.173902 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:10.174178 [debug] [MainThread]: On master: COMMIT
[0m08:45:10.175531 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m08:45:10.175904 [debug] [MainThread]: On master: Close
[0m08:45:10.176533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:10.176797 [debug] [MainThread]: Connection 'model.dbt_project.stg_eltool__state' was properly closed.
[0m08:45:10.177105 [info ] [MainThread]: 
[0m08:45:10.177485 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m08:45:10.178086 [debug] [MainThread]: Command end result
[0m08:45:10.185567 [info ] [MainThread]: 
[0m08:45:10.186010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:10.186435 [info ] [MainThread]: 
[0m08:45:10.186802 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m08:45:10.187230 [debug] [MainThread]: Flushing usage events
